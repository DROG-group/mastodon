- content_for :page_title do
  = t('admin.gamepatch.payments.payment_details')

- content_for :heading_actions do
  .actions
    = link_to t('admin.gamepatch.payments.back_to_payments'), admin_gamepatch_payments_payments_path, class: 'button button-secondary'
    - if @payment.paid? && !@payment.refunded?
      = link_to t('admin.gamepatch.payments.refund'), admin_gamepatch_payments_refund_payment_path(@payment), method: :post, data: { confirm: t('admin.gamepatch.payments.confirm_refund') }, class: 'button button--destructive'

.simple_form
  %h3= t('admin.gamepatch.payments.payment_info')

  .fields-group
    .input
      %label= t('admin.gamepatch.payments.id')
      .value= @payment.id

    .input
      %label= t('admin.gamepatch.payments.mollie_payment_id')
      .value
        %code= @payment.mollie_payment_id

    .input
      %label= t('admin.gamepatch.payments.account')
      .value
        - if @payment.account
          = link_to @payment.account.username, admin_account_path(@payment.account_id)
          - if @payment.account.display_name.present?
            %span.muted= "(#{@payment.account.display_name})"
        - else
          %em N/A

    .input
      %label= t('admin.gamepatch.payments.subscription')
      .value
        - if @payment.subscription
          = link_to "##{@payment.subscription.id} - #{@payment.subscription.tier.titleize}", admin_gamepatch_payments_subscription_path(@payment.subscription)
        - else
          %em N/A

    .input
      %label= t('admin.gamepatch.payments.status')
      .value
        %span.indicator-icon{ class: @payment.paid? ? 'success' : (@payment.failed? ? 'failure' : nil) }
        = @payment.status.titleize

    .input
      %label= t('admin.gamepatch.payments.amount')
      .value= "#{number_to_currency(@payment.amount, unit: "\u20AC")} #{@payment.currency}"

    .input
      %label= t('admin.gamepatch.payments.payment_method')
      .value= @payment.payment_method&.titleize || '-'

    .input
      %label= t('admin.gamepatch.payments.description')
      .value= @payment.description || '-'

    .input
      %label= t('admin.gamepatch.payments.paid_at')
      .value
        - if @payment.paid_at
          = l(@payment.paid_at)
        - else
          \-

    .input
      %label= t('admin.gamepatch.payments.created')
      .value= l(@payment.created_at)

- if @payment.metadata.present? && @payment.metadata.any?
  %hr.spacer

  %h3= t('admin.gamepatch.payments.metadata')

  .simple_form
    - @payment.metadata.each do |key, value|
      .input
        %label= key
        .value
          %code= value
